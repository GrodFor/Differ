name: Continuous Integration

on: [push]

jobs:
  test-xcode:
    name: Xcode Tests
    runs-on: macOS-latest
    strategy:
      matrix:
        destination: [
          "platform=macOS",
          "platform=iOS Simulator,name=iPhone Xs", 
          "platform=tvOS Simulator,name=Apple TV",
          "platform=watchOS Simulator,name=Apple Watch Series 4 - 44mm"
        ]

    steps:
    - uses: actions/checkout@v1
    - name: ${{ matrix.destination }}
      run: |
        xcrun xcodebuild test -destination "${{ matrix.destination }}" -project "Differ.xcodeproj" -scheme "Differ"
        bash <(curl -s https://codecov.io/bash)

  test-swift-package-manager:
    name: Swift Package Manager Tests
    runs-on: macOS-latest
    
    steps:
    - uses: actions/checkout@v1
    - name: swift test
      run: swift test
